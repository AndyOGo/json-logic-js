{"version":3,"file":"jsonLogic.js","sources":["../src/helpers/isArray.js","../src/helpers/isLogic.js","../src/helpers/getOperator.js","../src/createJsonLogic.js","../src/operations/accessor/variable.js","../src/operations/accessor/missing.js","../src/operations/accessor/missingSome.js","../src/operations/arithmetic/add.js","../src/operations/arithmetic/divide.js","../src/operations/arithmetic/modulo.js","../src/operations/arithmetic/multiply.js","../src/operations/arithmetic/substract.js","../src/operations/array/merge.js","../src/operations/logic/equal.js","../src/helpers/truthy.js","../src/operations/logic/falsy.js","../src/operations/logic/notEqual.js","../src/operations/logic/strictEqual.js","../src/operations/logic/strictNotEqual.js","../src/operations/logic/truthy.js","../src/operations/misc/indexOf.js","../src/operations/misc/log.js","../src/operations/misc/method.js","../src/operations/numeric/greater.js","../src/operations/numeric/greaterEqual.js","../src/operations/numeric/lower.js","../src/operations/numeric/lowerEqual.js","../src/operations/numeric/max.js","../src/operations/numeric/min.js","../src/operations/string/cat.js","../src/operations/string/substr.js","../src/visitors/array/all.js","../src/visitors/array/filter.js","../src/visitors/array/map.js","../src/visitors/array/none.js","../src/visitors/array/reduce.js","../src/visitors/array/some.js","../src/visitors/logic/and.js","../src/visitors/logic/condition.js","../src/visitors/logic/or.js","../src/helpers/getValues.js","../src/helpers/arrayUnique.js","../src/helpers/usesData.js","../src/helpers/ruleLike.js","../src/index.js"],"sourcesContent":["export default Array.isArray;\n","import isArray from './isArray';\n\nfunction isLogic(logic) {\n  return (\n    typeof logic === \"object\" && // An object\n    logic !== null && // but not null\n    !isArray(logic) && // and not an array\n    Object.keys(logic).length === 1 // with exactly one key\n  );\n}\n\nexport default isLogic;\n","function getOperator(logic) {\n  return Object.keys(logic)[0];\n}\n\nexport default getOperator;\n","import isArray from './helpers/isArray';\nimport isLogic from './helpers/isLogic';\nimport getOperator from './helpers/getOperator';\n\nfunction createJsonLogic(_operations, _visitors) {\n  const operations = {};\n  const visitors = {};\n\n  if (_operations) {\n    Object.keys(_operations).forEach(function(name) {\n      const operation = _operations[name];\n\n      addOperation(operation.code || name , operation);\n    });\n  }\n\n  if (_visitors) {\n    Object.keys(_visitors).forEach(function (name) {\n      const visitor = _visitors[name];\n\n      addVisitor(visitor.code || name, visitor);\n    });\n  }\n\n  function addOperation(name, code) {\n    operations[name] = code;\n  }\n\n  function removeOperation(name) {\n    delete operations[name];\n  }\n\n  function addVisitor(name, code) {\n    if (isArray(name)) {\n      name.forEach((key) => addVisitor(key, code));\n      return;\n    }\n\n    visitors[name] = code;\n  }\n\n  function removeVisitor(name) {\n    if (isArray(name)) {\n      name.forEach(removeVisitor);\n      return;\n    }\n\n    delete visitors[name];\n  }\n\n  function apply(logic, data) {\n    // Does this array contain logic? Only one way to find out.\n    if(isArray(logic)) {\n      return logic.map(function(l) {\n        return apply(l, data);\n      });\n    }\n    // You've recursed to a primitive, stop!\n    if( ! isLogic(logic) ) {\n      return logic;\n    }\n\n    data = data || {};\n\n    const op = getOperator(logic);\n    let values = logic[op];\n    let i;\n\n    // easy syntax for unary operators, like {\"var\" : \"x\"} instead of strict {\"var\" : [\"x\"]}\n    if( ! isArray(values)) {\n      values = [values];\n    }\n\n    // apply matching visitors first\n    if (typeof visitors[op] === 'function') {\n      return visitors[op](apply, data, values);\n    }\n\n    // Everyone else gets immediate depth-first recursion\n    values = values.map(function(val) {\n      return apply(val, data);\n    });\n\n    // The operation is called with \"data\" bound to its \"this\" and \"values\" passed as arguments.\n    // Structured commands like % or > can name formal arguments while flexible commands (like missing or merge) can operate on the pseudo-array arguments\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments\n    const operator = operations[op];\n    if(typeof operator === \"function\") {\n      if (operator.withApply) {\n        values.unshift(apply);\n      }\n\n      return operator.apply(data, values);\n    }else if(op.indexOf(\".\") > 0) { // Contains a dot, and not in the 0th position\n      var sub_ops = String(op).split(\".\");\n      var operation = operations;\n      for(i = 0; i < sub_ops.length; i++) {\n        // Descending into operations\n        operation = operation[sub_ops[i]];\n        if(operation === undefined) {\n          throw new Error(\"Unrecognized operation \" + op +\n            \" (failed at \" + sub_ops.slice(0, i+1).join(\".\") + \")\");\n        }\n      }\n\n      return operation.apply(data, values);\n    }\n\n    throw new Error(\"Unrecognized operation \" + op );\n  }\n\n  return {\n    apply,\n    add_operation: addOperation,\n    rm_operation: removeOperation,\n    add_visitor: addVisitor,\n    rm_visitor: removeVisitor,\n  };\n}\n\nexport default createJsonLogic;\n","function variable(a, b) {\n  const not_found = (b === undefined) ? null : b;\n  let data = this;\n\n  if(typeof a === \"undefined\" || a===\"\" || a===null) {\n    return data;\n  }\n\n  const sub_props = String(a).split(\".\");\n\n  for(let i = 0; i < sub_props.length; i++) {\n    if(data === null) {\n      return not_found;\n    }\n    // Descending into data\n    data = data[sub_props[i]];\n    if(data === undefined) {\n      return not_found;\n    }\n  }\n\n  return data;\n}\n\nvariable.code = 'var';\n\nexport default variable;\n","import isArray from '../../helpers/isArray';\nimport variable from './variable'\n\nfunction missing(apply, ...args) {\n  /*\n  Missing can receive many keys as many arguments, like {\"missing:[1,2]}\n  Missing can also receive *one* argument that is an array of keys,\n  which typically happens if it's actually acting on the output of another command\n  (like 'if' or 'merge')\n  */\n\n  var missing = [];\n  var keys = isArray(args[0]) ? args[0] : args;\n\n  for(var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = apply({\"var\": key}, this);\n    if(value === null || value === \"\") {\n      missing.push(key);\n    }\n  }\n\n  return missing;\n};\n\nmissing.withApply = true;\n\nexport default missing;\n","import missing from './missing';\n\nfunction missingSome(apply, need_count, options) {\n  // missing_some takes two arguments, how many (minimum) items must be present, and an array of keys (just like 'missing') to check for presence.\n  const are_missing = apply({\"missing\": options}, this);\n\n  if(options.length - are_missing.length >= need_count) {\n    return [];\n  }else{\n    return are_missing;\n  }\n}\n\nmissingSome.code = 'missing_some';\nmissingSome.withApply = true;\n\nexport default missingSome;\n","function add(...args) {\n  return args.reduce(function(a, b) {\n    return parseFloat(a, 10) + parseFloat(b, 10);\n  }, 0);\n}\n\nadd.code = '+';\n\nexport default add;\n","function divide(a, b) {\n  return a / b;\n}\n\ndivide.code = '/';\n\nexport default divide;\n","function modulo(a, b) {\n  return a % b;\n}\n\nmodulo.code = '%';\n\nexport default modulo;\n","function multiply(...args) {\n  return args.reduce(function(a, b) {\n    return parseFloat(a, 10) * parseFloat(b, 10);\n  }, 1);\n}\n\nmultiply.code = '*';\n\nexport default multiply;\n","function substract(a, b) {\n  if(b === undefined) {\n    return -a;\n  }else{\n    return a - b;\n  }\n}\n\nsubstract.code = '-';\n\nexport default substract;\n","function merge(...args) {\n  return args.reduce(function(a, b) {\n    return a.concat(b);\n  }, []);\n}\n\nexport default merge;\n","function equal(a, b) {\n  return a == b;\n}\n\nequal.code = '==';\n\nexport default equal;\n","import isArray from './isArray';\n\n/*\n  This helper will defer to the JsonLogic spec as a tie-breaker when different language interpreters define different behavior for the truthiness of primitives.  E.g., PHP considers empty arrays to be falsy, but Javascript considers them to be truthy. JsonLogic, as an ecosystem, needs one consistent answer.\n\n  Spec and rationale here: http://jsonlogic.com/truthy\n  */\nfunction truthy(value) {\n  if(isArray(value) && value.length === 0) {\n    return false;\n  }\n\n  return !!value;\n}\n\nexport default truthy;\n","import truthy from '../../helpers/truthy'\n\nfunction falsy(a) {\n  return !truthy(a);\n}\n\nfalsy.code = '!';\n\nexport default falsy;\n","function notEqual(a, b) {\n  return a != b;\n}\n\nnotEqual.code = '!=';\n\nexport default notEqual;\n","function strictEqual(a, b) {\n  return a === b;\n}\n\nstrictEqual.code = '===';\n\nexport default strictEqual;\n","function strictNotEqual(a, b) {\n  return a !== b;\n}\n\nstrictNotEqual.code = '!==';\n\nexport default strictNotEqual;\n","import truthy from '../../helpers/truthy'\n\ntruthy.code = '!!';\n\nexport default truthy;\n","function indexOf(a, b) {\n  if(!b || typeof b.indexOf === \"undefined\") return false;\n  return (b.indexOf(a) !== -1);\n}\n\nindexOf.code = 'in';\n\nexport default indexOf;\n","function log(a) {\n  console.log(a);\n\n  return a;\n}\n\nexport default log;\n","function method(obj, method, args) {\n  return obj[method].apply(obj, args);\n}\n\nexport default method;\n","function greater(a, b) {\n  return a > b;\n}\n\ngreater.code = '>';\n\nexport default greater;\n","function greaterEqual(a, b) {\n  return a >= b;\n}\n\ngreaterEqual.code = '>=';\n\nexport default greaterEqual;\n","function lower(a, b, c) {\n  return (c === undefined) ? a < b : (a < b) && (b < c);\n}\n\nlower.code = '<';\n\nexport default lower;\n","function lowerEqual(a, b, c) {\n  return (c === undefined) ? a <= b : (a <= b) && (b <= c);\n}\n\nlowerEqual.code = '<=';\n\nexport default lowerEqual;\n","function max() {\n  return Math.max.apply(this, arguments);\n}\n\nexport default max;\n","function min() {\n  return Math.min.apply(this, arguments);\n}\n\nexport default min;\n","function cat() {\n  return Array.prototype.join.call(arguments, \"\");\n}\n\nexport default cat;\n","function substr(source, start, end) {\n  if (end < 0) {\n    // JavaScript doesn't support negative end, this emulates PHP behavior\n    const temp = String(source).substr(start);\n    return temp.substr(0, temp.length + end);\n  }\n  return String(source).substr(start, end);\n};\n\nexport default substr;\n","import truthy from \"../../helpers/truthy\";\n\nfunction all(apply, data, values) {\n  const scopedData = apply(values[0], data);\n  const scopedLogic = values[1];\n  // All of an empty set is false. Note, some and none have correct fallback after the for loop\n  if( ! scopedData.length) {\n    return false;\n  }\n  for(let i=0; i < scopedData.length; i+=1) {\n    if( ! truthy( apply(scopedLogic, scopedData[i]) )) {\n      return false; // First falsy, short circuit\n    }\n  }\n  return true; // All were truthy\n}\n\nexport default all;\n","import isArray from '../../helpers/isArray';\nimport truthy from \"../../helpers/truthy\";\n\nfunction filter(apply, data, values) {\n  const scopedData = apply(values[0], data);\n  const scopedLogic = values[1];\n\n  if ( ! isArray(scopedData)) {\n    return [];\n  }\n  // Return only the elements from the array in the first argument,\n  // that return truthy when passed to the logic in the second argument.\n  // For parity with JavaScript, reindex the returned array\n  return scopedData.filter(function(datum){\n    return truthy( apply(scopedLogic, datum));\n  });\n}\n\nexport default filter\n","import isArray from '../../helpers/isArray';\n\nfunction map(apply, data, values) {\n  const scopedData = apply(values[0], data);\n  const scopedLogic = values[1];\n\n  if ( ! isArray(scopedData)) {\n    return [];\n  }\n\n  return scopedData.map(function(datum){\n    return apply(scopedLogic, datum);\n  });\n}\n\nexport default map;\n","function none(apply, data, values) {\n  const filtered = apply({'filter' : values}, data);\n\n  return filtered.length === 0;\n}\n\nexport default none;\n","import isArray from '../../helpers/isArray';\n\nfunction reduce(apply, data, values) {\n  const scopedData = apply(values[0], data);\n  const scopedLogic = values[1];\n  const initial = typeof values[2] !== 'undefined' ? values[2] : null;\n\n  if ( ! isArray(scopedData)) {\n    return initial;\n  }\n\n  return scopedData.reduce(\n    function(accumulator, current){\n      return apply(\n        scopedLogic,\n        {'current':current, 'accumulator':accumulator}\n      );\n    },\n    initial\n  );\n}\n\nexport default reduce;\n","function some(apply, data, values) {\n  const filtered = apply({'filter' : values}, data);\n\n  return filtered.length > 0;\n}\n\nexport default some;\n","import truthy from \"../../helpers/truthy\";\n\nfunction and(apply, data, values) {\n  let current;\n\n  for(let i=0; i < values.length; i++) {\n    current = apply(values[i], data);\n    if( ! truthy(current)) {\n      return current;\n    }\n  }\n  return current; // Last\n}\n\nexport default and;\n","import truthy from '../../helpers/truthy';\n\nfunction condition(apply, data, values) {\n  let i;\n\n  /* 'if' should be called with a odd number of parameters, 3 or greater\n    This works on the pattern:\n    if( 0 ){ 1 }else{ 2 };\n    if( 0 ){ 1 }else if( 2 ){ 3 }else{ 4 };\n    if( 0 ){ 1 }else if( 2 ){ 3 }else if( 4 ){ 5 }else{ 6 };\n\n    The implementation is:\n    For pairs of values (0,1 then 2,3 then 4,5 etc)\n    If the first evaluates truthy, evaluate and return the second\n    If the first evaluates falsy, jump to the next pair (e.g, 0,1 to 2,3)\n    given one parameter, evaluate and return it. (it's an Else and all the If/ElseIf were false)\n    given 0 parameters, return NULL (not great practice, but there was no Else)\n    */\n  for(i = 0; i < values.length - 1; i += 2) {\n    if( truthy( apply(values[i], data) ) ) {\n      return apply(values[i+1], data);\n    }\n  }\n\n  if(values.length === i+1) {\n    return apply(values[i], data);\n  }\n\n  return null;\n}\n\ncondition.code = ['if', '?:'];\n\nexport default condition;\n","import truthy from \"../../helpers/truthy\";\n\nfunction or(apply, data, values) {\n  let current;\n\n  for(let i=0; i < values.length; i++) {\n    current = apply(values[i], data);\n    if( truthy(current) ) {\n      return current;\n    }\n  }\n  return current; // Last\n}\n\nexport default or;\n","import getOperator from './getOperator'\n\nfunction getValues(logic) {\n  return logic[getOperator(logic)];\n}\n\nexport default getValues;\n","/**\n * Return an array that contains no duplicates (original not modified)\n * @param  {array} array   Original reference array\n * @return {array}         New array with no duplicates\n */\nfunction arrayUnique(array) {\n  const a = [];\n  for (let i=0, l=array.length; i<l; i++) {\n    if (a.indexOf(array[i]) === -1) {\n      a.push(array[i]);\n    }\n  }\n  return a;\n}\n\nexport default arrayUnique;\n","import isArray from './isArray';\nimport isLogic from './isLogic';\nimport getOperator from './getOperator';\nimport arrayUnique from './arrayUnique';\n\nfunction usesData(logic) {\n  var collection = [];\n\n  if(isLogic(logic) ) {\n    var op = getOperator(logic);\n    var values = logic[op];\n\n    if( ! isArray(values)) {\n      values = [values];\n    }\n\n    if(op === \"var\") {\n      // This doesn't cover the case where the arg to var is itself a rule.\n      collection.push(values[0]);\n    }else{\n      // Recursion!\n      values.map(function(val) {\n        collection.push.apply(collection, usesData(val) );\n      });\n    }\n  }\n\n  return arrayUnique(collection);\n};\n\nexport default usesData;\n","import isArray from './isArray';\nimport isLogic from './isLogic';\nimport getOperator from './getOperator';\nimport getValues from './getValues';\n\nfunction ruleLike(rule, pattern) {\n  // console.log(\"Is \". JSON.stringify(rule) . \" like \" . JSON.stringify(pattern) . \"?\");\n  if(pattern === rule) {\n    return true;\n  } // TODO : Deep object equivalency?\n  if(pattern === \"@\") {\n    return true;\n  } // Wildcard!\n  if(pattern === \"number\") {\n    return (typeof rule === \"number\");\n  }\n  if(pattern === \"string\") {\n    return (typeof rule === \"string\");\n  }\n  if(pattern === \"array\") {\n    // !logic test might be superfluous in JavaScript\n    return isArray(rule) && ! isLogic(rule);\n  }\n\n  if(isLogic(pattern)) {\n    if(isLogic(rule)) {\n      var pattern_op = getOperator(pattern);\n      var rule_op = getOperator(rule);\n\n      if(pattern_op === \"@\" || pattern_op === rule_op) {\n        // echo \"\\nOperators match, go deeper\\n\";\n        return ruleLike(\n          getValues(rule, false),\n          getValues(pattern, false)\n        );\n      }\n    }\n    return false; // pattern is logic, rule isn't, can't be eq\n  }\n\n  if(isArray(pattern)) {\n    if(isArray(rule)) {\n      if(pattern.length !== rule.length) {\n        return false;\n      }\n      /*\n        Note, array order MATTERS, because we're using this array test logic to consider arguments, where order can matter. (e.g., + is commutative, but '-' or 'if' or 'var' are NOT)\n      */\n      for(var i = 0; i < pattern.length; i += 1) {\n        // If any fail, we fail\n        if( ! ruleLike(rule[i], pattern[i])) {\n          return false;\n        }\n      }\n      return true; // If they *all* passed, we pass\n    }else{\n      return false; // Pattern is array, rule isn't\n    }\n  }\n\n  // Not logic, not array, not a === match for rule.\n  return false;\n}\n\nexport default ruleLike;\n","import createJsonLogic from './createJsonLogic';\nimport * as operations from './operations';\nimport * as visitors from './visitors';\nimport isLogic from \"./helpers/isLogic\";\nimport truthy from \"./helpers/truthy\";\nimport getOperator from \"./helpers/getOperator\";\nimport getValues from \"./helpers/getValues\";\nimport usesData from \"./helpers/usesData\";\nimport ruleLike from \"./helpers/ruleLike\";\n\nconst jsonLogic = createJsonLogic(operations, visitors);\n\n// restore original public API\njsonLogic.is_logic = isLogic;\njsonLogic.truthy = truthy;\njsonLogic.get_operator = getOperator;\njsonLogic.get_values = getValues;\njsonLogic.uses_data = usesData;\njsonLogic.rule_like = ruleLike;\n\nexport default jsonLogic;\n"],"names":["Array","isArray","isLogic","logic","Object","keys","length","getOperator","createJsonLogic","_operations","_visitors","operations","visitors","forEach","name","operation","addOperation","code","visitor","addVisitor","removeOperation","key","removeVisitor","apply","data","map","l","op","values","i","val","operator","withApply","unshift","indexOf","sub_ops","String","split","undefined","Error","slice","join","add_operation","rm_operation","add_visitor","rm_visitor","variable","a","b","not_found","sub_props","missing","args","value","push","missingSome","need_count","options","are_missing","add","reduce","parseFloat","divide","modulo","multiply","substract","merge","concat","equal","truthy","falsy","notEqual","strictEqual","strictNotEqual","log","console","method","obj","greater","greaterEqual","lower","c","lowerEqual","max","Math","arguments","min","cat","prototype","call","substr","source","start","end","temp","all","scopedData","scopedLogic","filter","datum","none","filtered","initial","accumulator","current","some","and","condition","or","getValues","arrayUnique","array","usesData","collection","ruleLike","rule","pattern","pattern_op","rule_op","jsonLogic","is_logic","get_operator","get_values","uses_data","rule_like"],"mappings":"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"}