!(function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(n=n||self).jsonLogic=r()})(this,(function(){"use strict";var d=Array.isArray;function r(n){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function s(n){return"object"===r(n)&&null!==n&&!d(n)&&1===Object.keys(n).length}function p(n){return Object.keys(n)[0]}function n(n,r){var t=void 0===r?null:r,e=this;if(void 0===n||""===n||null===n)return e;for(var o=String(n).split("."),u=0;u<o.length;u++){if(null===e)return t;if(void 0===(e=e[o[u]]))return t}return e}function t(n){for(var r=[],t=arguments.length,e=new Array(1<t?t-1:0),o=1;o<t;o++)e[o-1]=arguments[o];for(var u=d(e[0])?e[0]:e,i=0;i<u.length;i++){var f=u[i],c=n({var:f},this);null!==c&&""!==c||r.push(f)}return r}function e(n,r,t){var e=n({missing:t},this);return t.length-e.length>=r?[]:e}function o(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return r.reduce((function(n,r){return parseFloat(n,10)+parseFloat(r,10)}),0)}function u(n,r){return n/r}function i(n,r){return n%r}function f(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return r.reduce((function(n,r){return parseFloat(n,10)*parseFloat(r,10)}),1)}function c(n,r){return void 0===r?-n:n-r}function a(n,r){return n==r}function l(n){return(!d(n)||0!==n.length)&&!!n}function h(n){return!l(n)}function v(n,r){return n!=r}function y(n,r){return n===r}function g(n,r){return n!==r}function m(n,r){return!(!r||void 0===r.indexOf)&&-1!==r.indexOf(n)}function b(n,r){return r<n}function w(n,r){return r<=n}function j(n,r,t){return void 0===t?n<r:n<r&&r<t}function E(n,r,t){return void 0===t?n<=r:n<=r&&r<=t}n.code="var",t.withApply=!0,e.code="missing_some",e.withApply=!0,o.code="+",u.code="/",i.code="%",f.code="*",c.code="-",a.code="==",h.code="!",v.code="!=",y.code="===",g.code="!==",l.code="!!",m.code="in",b.code=">",w.code=">=",j.code="<",E.code="<=";var O=Object.freeze({variable:n,missing:t,missingSome:e,add:o,divide:u,modulo:i,multiply:f,substract:c,merge:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return r.reduce((function(n,r){return n.concat(r)}),[])},equal:a,falsy:h,notEqual:v,strictEqual:y,strictNotEqual:g,truthy:l,indexOf:m,log:function(n){return console.log(n),n},method:function(n,r,t){return n[r].apply(n,t)},greater:b,greaterEqual:w,lower:j,lowerEqual:E,max:function(){return Math.max.apply(this,arguments)},min:function(){return Math.min.apply(this,arguments)},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(n,r,t){if(t<0){var e=String(n).substr(r);return e.substr(0,e.length+t)}return String(n).substr(r,t)}});function A(n,r,t){var e;for(e=0;e<t.length-1;e+=2)if(l(n(t[e],r)))return n(t[e+1],r);return t.length===e+1?n(t[e],r):null}function S(n){return n[p(n)]}A.code=["if","?:"];var _=(function(t,e){var a={},l={};function o(n,r){a[n]=r}function u(n,r){d(n)?n.forEach((function(n){return u(n,r)})):l[n]=r}return t&&Object.keys(t).forEach((function(n){var r=t[n];o(r.code||n,r)})),e&&Object.keys(e).forEach((function(n){var r=e[n];u(r.code||n,r)})),{apply:function r(n,t){if(d(n))return n.map((function(n){return r(n,t)}));if(!s(n))return n;t=t||{};var e,o=p(n),u=n[o];if(d(u)||(u=[u]),"function"==typeof l[o])return l[o](r,t,u);u=u.map((function(n){return r(n,t)}));var i=a[o];if("function"==typeof i)return i.withApply&&u.unshift(r),i.apply(t,u);if(0<o.indexOf(".")){var f=String(o).split("."),c=a;for(e=0;e<f.length;e++)if(void 0===(c=c[f[e]]))throw new Error("Unrecognized operation "+o+" (failed at "+f.slice(0,e+1).join(".")+")");return c.apply(t,u)}throw new Error("Unrecognized operation "+o)},add_operation:o,rm_operation:function(n){delete a[n]},add_visitor:u,rm_visitor:function n(r){d(r)?r.forEach(n):delete l[r]}}})(O,Object.freeze({all:function(n,r,t){var e=n(t[0],r),o=t[1];if(!e.length)return!1;for(var u=0;u<e.length;u+=1)if(!l(n(o,e[u])))return!1;return!0},filter:function(r,n,t){var e=r(t[0],n),o=t[1];return d(e)?e.filter((function(n){return l(r(o,n))})):[]},map:function(r,n,t){var e=r(t[0],n),o=t[1];return d(e)?e.map((function(n){return r(o,n)})):[]},none:function(n,r,t){return 0===n({filter:t},r).length},reduce:function(t,n,r){var e=t(r[0],n),o=r[1],u=void 0!==r[2]?r[2]:null;return d(e)?e.reduce((function(n,r){return t(o,{current:r,accumulator:n})}),u):u},some:function(n,r,t){return 0<n({filter:t},r).length},and:function(n,r,t){for(var e,o=0;o<t.length;o++)if(!l(e=n(t[o],r)))return e;return e},condition:A,or:function(n,r,t){for(var e,o=0;o<t.length;o++)if(l(e=n(t[o],r)))return e;return e}}));return _.is_logic=s,_.truthy=l,_.get_operator=p,_.get_values=S,_.uses_data=function r(n){var t=[];if(s(n)){var e=p(n),o=n[e];d(o)||(o=[o]),"var"===e?t.push(o[0]):o.map((function(n){t.push.apply(t,r(n))}))}return (function(n){for(var r=[],t=0,e=n.length;t<e;t++)-1===r.indexOf(n[t])&&r.push(n[t]);return r})(t)},_.rule_like=function n(r,t){if(t===r)return!0;if("@"===t)return!0;if("number"===t)return"number"==typeof r;if("string"===t)return"string"==typeof r;if("array"===t)return d(r)&&!s(r);if(s(t)){if(s(r)){var e=p(t),o=p(r);if("@"===e||e===o)return n(S(r),S(t))}return!1}if(d(t)){if(d(r)){if(t.length!==r.length)return!1;for(var u=0;u<t.length;u+=1)if(!n(r[u],t[u]))return!1;return!0}return!1}return!1},_}));
//# sourceMappingURL=jsonLogic.min.js.map
